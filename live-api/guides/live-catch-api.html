---
title: 實時赶超API
description: 本主題介紹瞭如何使用 Live Catch-up API (TimeShift) 創建帶有追趕功能的實時作業。
parent: Guides 
grandparent: Live API
layout: staging
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Introduction">簡介</h2>
    <p>實時赶超API是對實時API的補充，它為直播流的開始或部分直播提供了重放功能，以允許後期的觀眾“趕上"。</p>
    <p>通過新功能將赶超能力添加到實時作業中<code translate="No">timeshift</code>創建實時作業時使用的對象字段。詳細的<code translate="No">timeshift</code>對象字段在以下各節中詳細介紹。</p>
  </section>
  <section class="bcls-section">
    <h2 id="timeshift_fields">時移字段</h2>
    <p>這<code translate="No">timeshift</code>對像是請求主體中用於創建實時作業請求的頂級對象。下表詳細列出了該對象的字段。</p>
    <table class="bcls-table">
      <caption class="bcls-caption--table"><code translate="No">timeshift</code>領域</caption>
      <thead class="bcls-table__head">
          <tr>
              <th>欄位</th>
              <th>描述</th>
          </tr>
      </thead>
      <tbody class="bcls-table__body">
          <tr>
              <td><code translate="No">startover_duration</code></td>
              <td>
                啟動窗口的大小（以秒為單位），最大為604800（7天）。
                <p>如果<code translate="No">timeshift.startover_duration</code>在請求中指定時，將為每個播放列表創建一個啟用了時移的播放URL。這些網址將支持實時邊緣播放（DVR大小由<code translate="No">live_duration</code>範圍）。</p>
                <p>通過附加參數，它們還將支持在startover_duration定義的時間段內播放任意部分。</p>
                <ul style="padding: 0;margin-left: 1rem;">
                  <li><code translate="No">start=ts</code> -播放開始的Unix紀元時間戳</li>
                  <li><code translate="No">end=ts</code> -播放結束的Unix紀元時間戳</li>
                </ul>
              </td>
          </tr>
          <tr>
              <td><code translate="No">live_duration</code></td>
              <td>活動窗口的大小（以秒為單位）最多為300。默認值為4 x分段持續時間。</td>
          </tr>
          <tr>
              <td><code translate="No">live_delay</code></td>
              <td>延遲實時輸出的秒數。最小和默認值為5秒。</td>
          </tr>
          <tr>
              <td><code translate="No">type</code></td>
              <td>
                <ul style="padding: 0;margin-left: 1rem;">
                  <li>單個-用於獨立的時移作業（默認）</li>
                  <li>primary-對於主要的時移工作（必須是<a href="/live-api/guides/live-api-static-entry-points.html">SEP工作</a>）</li>
                  <li>備份-用於備份時移作業</li>
                </ul>
              </td>
          </tr>
          <tr>
              <td><code translate="No">primary_job_id</code></td>
              <td>引用主要時移作業ID（如果類型為backup，則為必需）。</td>
          </tr>
          <tr>
              <td><code translate="No">skip_live_output</code></td>
              <td>不生成正常的現場或dvr播放列表（默認為false）</td>
          </tr>
      </tbody>
  </table>
  <h3>注意事項</h3>
  <ul>
    <li>請注意，如果timeshift.type為“backup"，則時間響應URL不包含在API響應中。使用為主要作業報告的時移URL。</li>
    <li>如果時移輸出需要DRM，請添加一個<code translate="No">drm</code>像往常一樣在工作請求中填寫該字段。只需要為主要作業指定此屬性，以保護時移輸出；但是，可能希望將所有備份作業的skip_live_output設置為true，以防止不受保護的播放。</li>
    <li>剪輯僅限於過去24小時，並且像實時冗餘一樣，將僅包括來自所選作業的輸入</li>
  </ul>
  </section>
  <section class="bcls-section">
    <h2 id="Sample_request_body">範例</h2>
    <h3>要求正文</h3>
<pre class="line-numbers"><code class="language-json" translate="No">{
  "live_stream": true,
  "region": "us-west-2",
  "reconnect_time": 300,
  "ad_insertion": false,
  "static": false,
  <span class="bcls-highlight">"timeshift": {
    "startover_duration": 36000,
    "type": "single",
    "live_delay": 20,
    "skip_live_output": true
  },</span>
  "drm":{"modes":["fairplay","widevine:dash","playready"]},
  "outputs": [...]
}</code></pre>
    <details>
      <summary><h2>樣品響應（部分）</h2></summary>
<pre class="line-numbers"><code class="language-json" translate="No">{
  "id": "e948ae380893403eb33bb99ef48f96ca",
  "outputs": [
    {
      "id": "2-e948ae380893403eb33bb99ef48f96ca",
      "playlist_type": "defaultS3",
      "type": "playlist",
      "drm": {
        "token": "eyJhb...",
        "modes": [
            {
              "type": "fairplay",
              "key_system": "com.apple.fps.1_0",
              "license_url": "https://license-proxy-qa.alive.us-west-2.qa.deploys.brightcove.com/lic/fp?token=eyJhb…",
              "certificate_url": "https://license-proxy-qa.alive.us-west-2.qa.deploys.brightcove.com/cert/fp?token=eyJhb...",
              "filename": "playlist_fp.m3u8",
              "dvr_filename": "playlist_fp_dvr.m3u8",
              "playback_url": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist_fp.m3u8",
              "playback_url_dvr": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist_fp_dvr.m3u8",
              <span class="bcls-highlight">"timeshift_url": "https://timeshift.bcovlive-dev.com/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/8343f7014c0ea438/88575623f08e4befbc5892ed09b2042e/playlist_ts.m3u8",</span>
              "playback_added_cdns": []
            },
            {
              "type": "widevine",
              "key_system": "com.widevine.alpha",
              "license_url": "https://license-proxy-qa.alive.us-west-2.qa.deploys.brightcove.com/lic/wv?token=eyJhb...",
              "filename": "playlist.mpd",
              "dvr_filename": "playlist_dvr.mpd",
              "playback_url": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist.mpd",
              "playback_url_dvr": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist_dvr.mpd",
              <span class="bcls-highlight">"timeshift_url": "https://timeshift.bcovlive-dev.com/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/8343f7014c0ea438/324e208d72ef47f78e78f430d007a97e/playlist_ts.mpd",</span>
              "playback_added_cdns": []
            },
            {
              "type": "playready",
              "key_system": "com.microsoft.playready",
              "license_url": "https://license-proxy-qa.alive.us-west-2.qa.deploys.brightcove.com/lic/pr?token=eyJhb...",
              "filename": "playlist.mpd",
              "dvr_filename": "playlist_dvr.mpd",
              "playback_url": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist.mpd",
              "playback_url_dvr": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist_dvr.mpd",
              <span class="bcls-highlight">"timeshift_url": "https://timeshift.bcovlive-dev.com/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/8343f7014c0ea438/324e208d72ef47f78e78f430d007a97e/playlist_ts.mpd",</span>
              "playback_added_cdns": []
            }
          ],
          "token_expires_in": 43200,
          "require_playback_token": false
      }
    }
  ],
} </code></pre>
    </details>
  </section>
  <section class="bcls-section">
    <h2 id="Getting_job_info">獲取工作詳細信息</h2>
    <p>無論您要請求一份工作清單或特定工作的詳細信息，<code translate="No">timeshift_url</code>將包含在啟用時移的作業中的任何播放列表中。調用者可以向該URL添加參數，以將開始和停止時間指定為Unix Epoch時間戳。例如：</p>
<pre><code class="language-http" translate="No">https://bcovlive-a.akamaihd.net/8d64308aafe34d17adb98af69e9eac13/us-east-1/6021289116001/ts-cf98fa7b2ee4450e-5df3aae6cb724fe1a4a932b4964d3e17/playlist_ts.m3u8?start=1593457200&end=1593460800</code></pre>
    <p>如果<code translate="No">start</code>和<code translate="No">end</code>參數不包括在內，回放將實時進行。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Create_Playback_Token">創建播放令牌</h2>
    <p>新字段已添加到播放令牌中，以允許Get Job Sources API返回時移URL。當前啟用了時移的作業不支持SSAI，因此<code translate="No">application_id</code>不應指定屬性。</p>
    <p>如果<code translate="No">ts_start</code>和<code translate="No">ts_end</code>被指定，它們將作為查詢參數添加到播放URL中，如上一節所述。</p>
    <h3>新領域</h3>
    <table class="bcls-table">
      <caption class="bcls-caption--table">新的播放令牌字段</caption>
      <thead class="bcls-table__head">
          <tr>
              <th>欄位</th>
              <th>描述</th>
          </tr>
      </thead>
      <tbody class="bcls-table__body">
          <tr>
              <td><code translate="No">ts</code></td>
              <td>選擇時移播放URL（true | false，可選，默認為false）</td>
          </tr>
          <tr>
              <td><code translate="No">ts_start</code></td>
              <td>用於啟動重新啟動窗口的Unix紀元時間戳（數字，可選）</td>
          </tr>
          <tr>
              <td><code translate="No">ts_end</code></td>
              <td>啟動窗口結束的Unix時代時間戳記（數字，可選）</td>
          </tr>
      </tbody>
  </table>
  </section>
</article>