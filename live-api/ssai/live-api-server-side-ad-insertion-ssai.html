---
title: 'Brightcove 實時 API：伺服器端廣告插入 (SSAI) '
description: 本主題向您展示如何為直播作業設置服務器端廣告插入 (SSAI)。
parent: SSAI 
grandparent: Live API
---
 <h1>此頁面已移動 - 您將被定向到<a href="https://apis.support.brightcove.com/live-api/ssai/live-api-server-side-ad-insertion-ssai.html">新地點</a>在 3 秒內。請更新您的書籤！</h1>
<script type="text/javascript">
var t = setTimeout(function() { window.location.href = 'https://apis.support.brightcove.com/live-api/ssai/live-api-server-side-ad-insertion-ssai.html'; } , 3000);
</script>
<h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  {% raw %}
<section class="bcls-section">
<h2 id="Overview">概述</h2>

<p><span translate="No">SSAI</span>允許您在直播活動期間的指定時間展示廣告。主要功能包括：</p>

<ul>
	<li>使用從編碼器發送的提示點插入廣告或使用<span translate="No">實時 API</span></li>
	<li>提取“板岩"資產以填充所有未使用的廣告時間</li>
	<li>避免將廣告屏蔽在服務器端的實時流中，以阻止廣告攔截</li>
</ul>

<aside class="bcls-aside bcls-aside--information">
  <ul>
    <li>在您可以使用之前<span translate="No">SSAI</span>，必須為您的帳戶啟用它。如需詳細資訊，請聯絡您的客戶經理</li>
 </ul>


</aside>

<p>要使用服務器端廣告創建實時流，請按照以下步驟操作：</p>

<ol class="bcls-tasklist-restart">
	<li><a href="#General_information">查看有關Live API的常規信息</a></li>
	<li><a href="#Create_an_ad_configuration">創建實時廣告配置</a>。您也可以在<a href="https://studio.support.brightcove.com/admin/configuring-server-side-ad-settings.html#bc-ipnav-1">Video Cloud Studio</a>。有關使用Live API管理廣告配置的詳細信息，請參見以下部分。</li>
	<li><a href="#Managing_slates">創建板岩資產</a>。如果您喜歡UI，可以<a href="/live-module/implementing-server-side-ads-live-module.html#fill_slate">在Studio中管理板岩</a>。</li>
	<li>可選的：<a href="/live-api/ssai/live-api-cue-points-and-ad-beacons-ssai.html">插入提示點和廣告信標</a>。</li>
	<li>現在，您準備好了<a href="/live-api/getting-started/quick-start-create-live-stream-using-brightcove-live-api.html">使用Live API創建實時流</a>。如果您想使用Studio，可以<a href="/live-module/implementing-server-side-ads-live-module.html">在實時模塊中實施服務器端廣告</a></li>
</ol>

<p>有關使用DFP廣告管理系統和廣告宏的自定義標題，廣告配置變量的詳細信息，請參閱本文檔的其餘部分。</p>
</section>

<section class="bcls-section">
<h2 id="General_information">一般信息</h2>

<p>以下信息適用於所有帶有SSAI請求的Live API。</p>

<h3>基本網址</h3>

<p>使用SSAI的Live API的基本URL是：</p>

<pre>
    <code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai</code></pre>

<h3>驗證</h3>

<p>對請求的身份驗證需要帶有API密鑰的標頭：</p>

<pre class="line-numbers">
    <code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span>
    </code></pre>

<p>請與您的客戶經理聯繫，以獲取與您的帳戶相關聯的API密鑰。</p>
</section>

<section class="bcls-section">
<h2 id="Create_an_ad_configuration">建立廣告組態</h2>

<p>要創建新的廣告配置，請發送一個<code translate="No">POST</code>要求如下：</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<th>方法</th>
			<td style="width:80em;"><code class="language-http" translate="No">POST</code></td>
		</tr>
		<tr>
			<th>網址</th>
			<td><code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai/applications</code></td>
		</tr>
		<tr>
			<th>標頭</th>
			<td><code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span></code></td>
		</tr>
	</tbody>
</table>

<h3>樣品索取主體</h3>
<pre class="line-numbers">
    <code class="language-json" translate="No">{
      "application_ad_configuration": {
        "ad_configuration_description": "Human readable description of the configuration",
        "ad_configuration_expected_response_type": "<span class="bcls-input">Dfp, Vast or SmartXML</span>",
        "ad_configuration_headers": {
        "X-Custom-Header-Rand": "{{random.int32}}",
        "X-VIDEOPLAZA-FORWARDED-FOR": "{{client.ipaddress}}"
        },
        "ad_configuration_headers_for_impressions": false,
        "ad_configuration_strategy": "<span class="bcls-input">SingleAdResponse or MultipleAdResponse</span>",
        "ad_configuration_transforms": [
          {
          "xpath": "/",
          "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
          }
        ],
        "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
      },
      "application_description": "Human readable description of the ad application",
      "account_id": "<span class="bcls-input">User's Account ID [Optional]</span>"
    }</code></pre>
<aside class="bcls-aside bcls-aside--information">這<code translate="No">account_id </code>字段是真實賬戶 ID。如果省略，則使用請求用戶的帳戶 ID。</aside>

<h3>樣品回复</h3>

<pre class="line-numbers">
    <code class="language-json" translate="No">{
      "application": {
        "account_id": "User Account ID",
        "application_description": "Human readable description of the ad application",
        "application_ad_configuration": {
          "ad_configuration_description": "Human readable description of the configuration",
          "ad_configuration_expected_response_type": "<span class="bcls-highlight">Dfp | Vast | SmartXML</span>",
          "ad_configuration_headers": {
            "X-Custom-Header-Rand": "{{random.int32}}",
            "X-VIDEOPLAZA-FORWARDED-FOR": "{{client.ipaddress}}"
          },
          "ad_configuration_headers_for_impressions": false,
          "ad_configuration_strategy": "<span class="bcls-highlight">SingleAdResponse | MultipleAdResponse</span>",
          "ad_configuration_transforms": [
            {
              "xpath": "/",
              "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
            }
          ],
          "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
        },
        "application_id": <span class="bcls-highlight">"Application ID"</span>
      },
      "inserted": true
    }</code></pre>
</section>

<section class="bcls-section">
<h2 id="Update_an_ad_configuration">更新廣告配置</h2>

<p>更新廣告配置與創建廣告配置非常相似。做一個<code translate="No">PUT</code>要求如下：</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<th>方法</th>
			<td style="width:80em;"><code class="language-http" translate="No">PUT</code></td>
		</tr>
		<tr>
			<th>網址</th>
			<td><code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai/applications/application/<span class="bcls-input">Application_ID</span></code></td>
		</tr>
		<tr>
			<th>標頭</th>
			<td><code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span></code></td>
		</tr>
	</tbody>
</table>

<h3>樣品索取主體</h3>

<pre class="line-numbers">
    <code class="language-json" translate="No">{
      "application_ad_configuration": {
        "ad_configuration_description": "Some Updated Description Value",
        "ad_configuration_expected_response_type": "<span class="bcls-input">Dfp or Vast or SmartXML</span>,
        "ad_configuration_headers": {
          "X-Custom-Header-Rand": "{{random.int32}}",
          "X-VIDEOPLAZA-FORWARDED-FOR": "{{client.ipaddress}}"
        },
        "ad_configuration_headers_for_impressions": false,
        "ad_configuration_strategy": "<span class="bcls-input">SingleAdResponse or MultipleAdResponse</span>",
        "ad_configuration_transforms": [
          {
          "xpath": "/",
          "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
          }
        ],
        "ad_configuration_url_format": "https://updated-ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
      },
      "application_description": "Human readable description of the ad application",
      "account_id": "<span class="bcls-input">User's Account ID [Optional]</span>"
    }</code></pre>

<aside class="bcls-aside bcls-aside--information">這<code translate="No">account_id </code>字段是真實賬戶 ID。如果省略，則使用請求用戶的帳戶 ID。</aside>

<h3>樣品回复</h3>

<pre class="line-numbers">
    <code class="language-json" translate="No">{
      "account_id": "User Account ID",
      "application_description": "Human readable description of the ad application",
      "application_ad_configuration": {
        "ad_configuration_description": "Some Updated Description Value",
        "ad_configuration_expected_response_type": "<span class="bcls-highlight">Dfp | Vast | SmartXML</span>",
        "ad_configuration_headers": {
        "X-Custom-Header-Rand": "{{random.int32}}",
        "X-VIDEOPLAZA-FORWARDED-FOR": "{{client.ipaddress}}"
        },
        "ad_configuration_headers_for_impressions": false,
        "ad_configuration_strategy": "<span class="bcls-highlight">SingleAdResponse | MultipleAdResponse</span>",
        "ad_configuration_transforms": [
          {
          "xpath": "/",
          "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
          }
        ],
        "ad_configuration_url_format": "https://updated-ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
      },
      "application_id": <span class="bcls-highlight">"Application ID"</span>
    }</code></pre>
</section>

<section class="bcls-section">
<h2 id="Get_all_ad_configurations">獲取所有廣告配置</h2>

<p>要檢索帳戶的所有廣告配置，請提交一個<code translate="No">GET </code>要求如下：</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<th>方法</th>
			<td style="width:80em;"><code class="language-http" translate="No">GET</code></td>
		</tr>
		<tr>
			<th>網址</th>
			<td><code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai/applications/account/<span class="bcls-input">Account_ID</span></code></td>
		</tr>
		<tr>
			<th>標頭</th>
			<td><code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span></code></td>
		</tr>
	</tbody>
</table>

<aside class="bcls-aside bcls-aside--information">這<code translate="No">Account_ID</code>這是真實賬戶 ID。</aside>

<h3>樣品回复</h3>

<pre class="line-numbers">
    <code class="language-json" translate="No">[
      {
        "application_id": "Application_ID_1",
        "application_description": "DFP Single Midroll",
        "application_ad_configuration": {
        "ad_configuration_description": "DFP Test Config Single Midroll",
        "ad_configuration_strategy": "MultipleAdResponse",
        "ad_configuration_transforms": [],
        "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler",
        "ad_configuration_expected_response_type": "Dfp"
        },
        "account_id": "Account_ID"
      },
      {
        "application_id": "Application_ID_2",
        "application_description": "Test DFP Single Midroll"
        "application_ad_configuration": {
        "ad_configuration_description": "DFP Test Config Single Midroll",
        "ad_configuration_strategy": "MultipleAdResponse",
        "ad_configuration_transforms": [
        {
          "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;",
          "xpath": "/"
        }
        ],
        "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}",
        "ad_configuration_expected_response_type": "Dfp"
        },
        "account_id": "Account_ID"
      }
    ]</code></pre>
</section>

<section class="bcls-section">
<h2 id="Get_an_ad_configuration">獲取廣告配置</h2>

<p>您還可以通過其特定的廣告配置來檢索<code translate="No">application_id </code>通過發送一個<code translate="No">GET</code>要求如下：</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<th>方法</th>
			<td style="width:80em;"><code class="language-http" translate="No">GET</code></td>
		</tr>
		<tr>
			<th>網址</th>
			<td><code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai/applications/application/<span class="bcls-input">Application_ID</span></code></td>
		</tr>
		<tr>
			<th>標頭</th>
			<td><code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span></code></td>
		</tr>
	</tbody>
</table>

<h3>樣品回复</h3>

<pre class="line-numbers">
    <code class="language-json" translate="No">{
      "application_id": "Application_ID",
      "application_description": "Test DFP Single Midroll",
      "application_ad_configuration": {
        "ad_configuration_description": "DFP Test Config Single Midroll",
        "ad_configuration_strategy": "MultipleAdResponse",
        "ad_configuration_transforms": [
          {
          "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;",
          "xpath": "/"
          }
        ],
        "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}",
        "ad_configuration_expected_response_type": "Dfp"
      },
      "account_id": "Account_ID"
    }</code></pre>
</section>

<section class="bcls-section">
<h2 id="Delete_an_ad_configuration">刪除廣告配置</h2>

<p>要刪除廣告配置，請發送<code translate="No">DELETE</code>要求如下：</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<th>方法</th>
			<td style="width:80em;"><code class="language-http" translate="No">DELETE</code></td>
		</tr>
		<tr>
			<th>網址</th>
			<td><code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai/applications/application/<span class="bcls-input">APPLICATION_ID</span></code></td>
		</tr>
		<tr>
			<th>標頭</th>
			<td><code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span></code></td>
		</tr>
	</tbody>
</table>

<h3>樣品回复</h3>

<pre class="line-numbers">
    <code class="language-json" translate="No">{
    "application_id": "Application_ID",
    "deleted": true
    }</code></pre>
</section>

<section class="bcls-section">
<h2 id="Managing_slates">管理板岩</h2>

<p>板岩是您自己的資產，用於填充未使用的廣告時間。您可以使用板岩來提供“馬上回來"消息或您喜歡的任何內容。</p>

<p>以下是有關添加和管理板岩資產的API請求的詳細信息。</p>

<h3>添加板岩資產</h3>

<p>要提取新的slate媒體源資產，請提交<code translate="No">POST</code>要求：</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<th>方法</th>
			<td style="width:80em;"><code class="language-http" translate="No">POST</code></td>
		</tr>
		<tr>
			<th>網址</th>
			<td><code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai/slates</code></td>
		</tr>
		<tr>
			<th>標頭</th>
			<td><code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span></code></td>
		</tr>
	</tbody>
</table>

<h4>樣品索取主體</h4>

<pre class="line-numbers">
    <code class="language-json" translate="No">{
      "source_url": "https://somesourceasset.com/slate-to-ingest.mp4",
      "account_id": "<span class="bcls-input">Account_ID [Optional]</span>",
      "source_description": "<span class="bcls-input">User identifiable description for the slate  [Optional]</span>"
    }
    </code>
    </pre>

<aside class="bcls-aside bcls-aside--information">這<code translate="No">account_id </code>這是真實賬戶 ID。如果省略，則使用請求用戶的帳戶 ID。</aside>

<h4>樣品回复</h4>

<pre class="line-numbers">
    <code class="language-json" translate="No">{
      "media_source_asset_id": "New_UUID",
      "account_id": "Account_ID",
      "media_source_asset_default": false,
      "media_source_asset_type": "slate",
      "media_source_asset_url": "https://somesourceasset.com/slate-to-ingest.mp4",
      "media_source_asset_status": "transcoding"
      "media_source_asset_description": "User identifiable description for the slate"
    }</code></pre>

<aside class="bcls-aside bcls-aside--information">注意：那個設置<code translate="No">media_source_asset_default</code>是<strong>不是</strong>此時支持。</aside>

<h3>刪除板岩資產</h3>

<p>要刪除平板媒體資源資產，請發送<code translate="No">DELETE</code>要求：</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<th>方法</th>
			<td style="width:80em;"><code class="language-http" translate="No">DELETE</code></td>
		</tr>
		<tr>
			<th>網址</th>
			<td><code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai/slates/slate/<span class="bcls-input">Slate_MSA_ID</span></code></td>
		</tr>
		<tr>
			<th>標頭</th>
			<td><code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span></code></td>
		</tr>
	</tbody>
</table>

<h4>樣品回复</h4>

<pre class="line-numbers">
    <code class="language-json" translate="No">{
      "media_source_asset_id": "MSA_UUID",
      "media_source_asset_type": "slate",
      "media_source_asset_url": "http://someS3urlpath/media.mp4",
      "media_source_asset_default": false,
      "media_source_asset_status": "ready",
      "account_id": "ACCOUNT_ID"
    }</code></pre>

<h3>獲取板岩資產</h3>

<p>您可以通過發送以下信息來檢索該帳戶的所有平板媒體資源資源的數組：<code translate="No">GET</code>要求：</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<th>方法</th>
			<td style="width:80em;"><code class="language-http" translate="No">GET</code></td>
		</tr>
		<tr>
			<th>網址</th>
			<td><code class="language-http" translate="No">https://api.bcovlive.io/v1/ssai/slates/account/<span class="bcls-input">Account_ID</span></code></td>
		</tr>
		<tr>
			<th>標頭</th>
			<td><code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">your API KEY</span></code></td>
		</tr>
	</tbody>
</table>

<aside class="bcls-aside bcls-aside--information">這<code translate="No">Account_ID </code>這是真實賬戶 ID。</aside>

<h4>樣品回复</h4>

<pre class="line-numbers">
    <code class="language-json" translate="No">[
      {
      "media_source_asset_id": "MSA_UUID_1",
      "media_source_asset_type": "slate",
      "media_source_asset_default": false,
      "media_source_asset_url": "http://someS3urlpath.com/media.mp4",
      "account_id": "ACCOUNT_ID",
      "media_source_asset_status": "ready"
      },
      {
      "media_source_asset_id": "MSA_UUID_2",
      "media_source_asset_type": "slate",
      "media_source_asset_default": true,
      "media_source_asset_url": "http://someS3urlpath.com/media.mp4",
      "account_id": "ACCOUNT_ID",
      "media_source_asset_status": "ready"
      }
    ]</code></pre>
</section>

<section class="bcls-section">
<h2 id="Notes_about_DFP">關於DFP的注意事項</h2>

<p>如果您要從DFP廣告管理系統中獲取廣告，請記住以下幾點以防止出現問題。</p>

<h3>廣告代碼</h3>

<p>為Live創建廣告代碼時，請確保遵循正確的準則，包括<code translate="No">/live </code>。參見DFP文檔<a href="https://support.google.com/dfp_premium/answer/1068325?hl=en">手動創建主視頻標籤</a>有關完整的詳細信息。</p>

<h3>並發</h3>

<p>如果期望大量並發，建議您與DFP客戶小組進行交流。</p>

<h3>單個/多個廣告響應</h3>

<p>這<code translate="No">singleadresponse </code>和<code translate="No">multiadresponse </code>參數當前未被使用<span translate="No">SSAI</span> .</p>

<p>居住<span translate="No">SSAI</span>只進行一次廣告服務器調用，並期望響應包含中斷的所有廣告，但它會遵循任何必要的廣告包裝器，每個廣告限制為 5 次重定向。可接受以下廣告響應格式，並將其解析如下：</p>

<ul>
	<li>VAST-單個響應或單個響應中的廣告連播</li>
	<li>DFP廣告管理系統廣告規則-匯總響應中所有可用的廣告，包括片前，片中，片後定義的廣告</li>
	<li>Smart XML-匯總響應中的所有可用廣告，包括片前，片中，片後定義的廣告</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Custom_headers_for_ad_requests">廣告請求的自定義標題</h2>

<p>這<span translate="No">SSAI</span>平台可以通過 Ad 調用和後端平台使用的所有信標傳遞自定義標頭。某些廣告服務器（例如VideoPlaza）需要自定義標頭。</p>

<p>自定義標頭被指定為一組<code translate="No">ad_configuration_headers</code>對象，它是<code translate="No">application_ad_configuration </code>（請參閱<a href="#Create_an_ad_configuration">創建廣告配置</a>部分）。</p>

<h3>注意事項</h3>

<ul>
	<li>默認情況下處理標準頭，例如：
	<ul>
		<li><code translate="No">X-Forwarded-For </code></li>
		<li><code translate="No">X-Device-User-Agent </code></li>
	</ul>
	</li>
	<li>標頭值可以使用<a href="#Ad_configuration_variables">廣告配置變量</a></li>
	<li>標頭值也可以是靜態字符串</li>
</ul>

<aside class="bcls-aside bcls-aside--warning">標頭將傳遞給所有下游請求，包括廣告包裝或展示次數/四分位數，因此您應謹慎使用它們。</aside>
</section>

<section class="bcls-section">
<h2 id="Targeting_ads_using_ad_macros">使用廣告宏定位廣告</h2>

<p>當你<a href="#Create_an_ad_configuration">創建廣告配置</a>，您的廣告代碼通常如下所示：</p>

<pre>
      <code class="language-http" translate="No">https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;
      num={{random.int32}}&amp;ses={{session.session_id}}&amp;IDFA={{deviceid}}&amp;
      sitesection={{sitesection}}&amp;breakid={{breakid}}&amp;breaktheme={{breaktheme}}</code></pre>

<p>雙花括號內的項目是變量，也稱為廣告宏，Brightcove Live在發送廣告請求時會將其替換為值（如果存在）。</p>

<aside class="bcls-aside bcls-aside--information">
  <p>注意事項：</p>
  <ul>
    <li>有用的變量取決於廣告服務器。</li>
    <li>Brightcove URI會對插入到廣告服務器URL中的任何值進行編碼。</li>
    <li>如果一個鍵有多個值，則廣告服務器將無法讀取編碼後的變量。這是因為URI編碼。</li>
  </ul>
</aside>

<p>可以通過以下方式提供廣告宏值：</p>

<ul>
	<li><a href="#Using_header_information">使用標題信息</a></li>
	<li><a href="#Appending_the_URL">附加網址</a></li>
	<li><a href="#Adding_URLs_dynamically">動態添加URL</a></li>
	<li><a href="#Using_manual_cue_points">使用手動提示點</a></li>
</ul>

<h3 id="Using_header_information">使用標題信息</h3>

<p>標頭信息，請參見<a href="#Ad_configuration_variables">廣告配置變量</a>以上部分適用於任何要求。只需在廣告配置中使用適當的鍵名稱指定所需的變量即可。</p>

<h3 id="Appending_the_URL">附加網址</h3>

<p>可以將其他會話值附加到實時流的URL，如下所示：</p>

<pre>
      <code class="language-http" translate="No">http://playback.bcovlive.io/e058d9f2737e18/us-west-2/NA/
      playlist.m3u8<span class="bcls-highlight">?deviceid=123456&amp;sitesection=services</span>"</code></pre>

<h3 id="Adding_URLs_dynamically">動態添加URL</h3>

<p>您可以使用Javascript和Brightcove Player API動態添加URL：</p>

<pre class="line-numbers">
      <code class="language-html" translate="No">&lt;!DOCTYPE html&gt;
      &lt;body&gt;
        &lt;video
        id="myPlayerID"
        data-video-id="5975635167001"
        data-account="3737230870001"
        data-player="tIG7lVKBm"
        data-embed="default"
        data-application-id
        class="video-js"
        controls
        width="640"
        height="360"&gt;&lt;/video&gt;
        &lt;script src="//players.brightcove.net/3737230870001/tIG7lVKBm_default/index.min.js"&gt;&lt;/script&gt;

        &lt;script type="text/javascript"&gt;
        var player = videojs("myPlayerID");

        player.one("loadstart", function(){
          var sourceUrl = player.currentSource();
          console.log(sourceUrl);
          var liveUrlWithParams = sourceUrl.src + "?player_width={width}&amp;player_height={height}&amp;deviceid={deviceid}";

          player.src([{
            "type": "application/vnd.apple.mpegurl",
            "src": liveUrlWithParams
          }]);
        });
      &lt;/script&gt;

      &lt;/body&gt;</code></pre>

<p>請注意，此示例中的鍵名與上面顯示的廣告代碼中的變量名相對應。</p>
</section>

<section class="bcls-section">
<h2 id="Ad_configuration_variables">廣告配置變量</h2>

<p>廣告配置變量（也稱為信標）可用於請求中以管理廣告配置。有關詳細信息，請參見<a href="/live-api/ssai/live-api-cue-points-and-ad-beacons-ssai.html#Beacons">實時API：SSAI的提示點和廣告信標</a>文檔。</p>
</section>

<section class="bcls-section">
<h2 id="Using_manual_cue_points">使用手動提示點</h2>

<p>特定廣告間隔的值可以與手動提示點插入請求一起發送。有關詳細信息，請參見<a href="/live-api/ssai/live-api-cue-points-and-ad-beacons-ssai.html#Manual_cue_point_insertion">實時API：提示點和廣告信標</a>文檔。</p>
</section>

<section class="bcls-section">
<h2 id="Known_issues">已知問題</h2>

<ul>
	<li>SSAI要求實時流式傳輸視頻具有音軌。</li>
	<li>如果返回的VAST具有相同的廣告ID，則即使廣告URL使用動態變量來使其成為唯一URL，服務器也不會請求廣告內容。這確實<strong>不是</strong>如果您將DFP廣告管理系統用於廣告，則應用。</li>
	<li>使用DFP廣告管理系統，雖然您可以使用相同的廣告ID，但仍然需要使用其他廣告素材ID-換句話說，您不能簡單地交換MediaFile。</li>
	<li>
	<p>如果廣告間隔的持續時間小於廣告URL的最大持續時間（min_ad_duration = 0＆max_ad_duration = 30000），則如果返回的廣告時間超過了廣告間隔，則該廣告將不會播放。</p>
	</li>
	<li>
	<p>不支持 VPAID 或可點擊廣告<span translate="No">Brightcove Live SSAI</span> .</p>
	</li>
	<li>
	<p>當廣告間隔的剩餘時間短於流的片段秒數並顯示一個石板時，將顯示該石板的片段時長，並且實際的廣告間隔將比預期的長。</p>
   <li>
     <p>上面的內容可能會導致以下廣告中斷之一被延遲持續時間縮短，以嘗試將會話恢復為實時狀態。</p></li>
	</li>
	<li>我們的系統第一次看到廣告時，直到廣告轉碼並準備好發送後才會播放。</li>
	<li>當前不支持Live SSAI的VMAP。</li>
</ul>
</section>
{% endraw %}

</article>